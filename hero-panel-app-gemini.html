<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éŠ·å”®è‹±é›„é¢æ¿ - Gemini AI æ‡‰ç”¨ (æœ€å…¼å®¹ç‰ˆ)</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; background-color: #f4f7f9; color: #333; }
        .container { max-width: 900px; margin: auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1); }
        h1 { color: #007bff; text-align: center; margin-bottom: 30px; }
        .input-group, .profile-group { margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 8px; background-color: #fafafa; }
        label { display: block; font-weight: bold; margin-bottom: 8px; color: #555; }
        input[type="text"], textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; margin-top: 5px; }
        textarea { resize: vertical; min-height: 80px; }
        .button-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 20px; }
        .prompt-button { padding: 15px 10px; background-color: #28a745; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; transition: background-color 0.2s; }
        .prompt-button:hover { background-color: #218838; }
        .prompt-button:active { background-color: #1e7e34; }
        #response-area { margin-top: 30px; padding: 15px; background-color: #e9f7ff; border: 1px solid #cce5ff; border-radius: 8px; white-space: pre-wrap; word-wrap: break-word; min-height: 100px; }
        .loading { text-align: center; padding: 10px; color: #007bff; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ“ éŠ·å”®è‹±é›„ AI è¼”åŠ©é¢æ¿ (æœ€å…¼å®¹ç‰ˆ)</h1>
    <p>âœ… **æœ€çµ‚ä¿®æ­£ï¼š** ç§»é™¤ä¸å…¼å®¹çš„ System Role/Instruction åƒæ•¸ï¼Œå°‡äººè¨­æŒ‡ä»¤åˆä½µåˆ° User Prompt ä¸­ï¼Œç¢ºä¿ç›¸å®¹æ€§ã€‚</p>

    <div class="input-group">
        <label for="apiKey">ğŸ”‘ Gemini API Key (è«‹è²¼ä¸Šä½ çš„ Key)</label>
        <input type="text" id="apiKey" placeholder="ä¾‹å¦‚: AIzaSy... è«‹ä¿å¯†" required>
    </div>

    <div class="profile-group">
        <h2>ğŸ§‘â€ğŸ¦± å®¢æˆ¶è¼ªå»“è¨­å®š (èƒŒæ™¯è³‡è¨Š)</h2>
        <label for="customerProfile">å®¢æˆ¶ç°¡è¿° (ä¾‹å¦‚: 68æ­²å¥³æ€§, æ³¨é‡é¤Šç”Ÿ, ä½åœ¨å°åŒ—)</label>
        <textarea id="customerProfile" placeholder="è«‹è¼¸å…¥å®¢æˆ¶çš„åŸºæœ¬è³‡è¨Šï¼Œå¹«åŠ© AI èª¿æ•´è©±è¡“èªæ°£èˆ‡å…§å®¹..." rows="3">35æ­²ç”·æ€§ï¼Œä¸€å®¶ä¸‰å£ï¼Œæœ‰å€‹å°å¥³å…’ï¼Œæˆ‘æƒ³è³£ä¿éšªçµ¦ä»–ã€‚</textarea>
    </div>

    <h2>ğŸ¯ å®¢æˆ¶æ‹’çµ•è™•ç†</h2>
    <div class="button-grid">
        <button class="prompt-button" onclick="sendPrompt('å¤ªè²´äº†ï¼Œåƒ¹æ ¼é«˜æ–¼é ç®—')">ğŸ’° åƒ¹æ ¼å¤ªè²´</button>
        <button class="prompt-button" onclick="sendPrompt('æˆ‘è¦å†è€ƒæ…®ä¸€ä¸‹')">ğŸ¤” æˆ‘è¦è€ƒæ…®</button>
        <button class="prompt-button" onclick="sendPrompt('è¦å•å®¶äºº/ä¼´ä¾¶çš„æ„è¦‹')">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ å•å®¶äºº/ä¼´ä¾¶</button>
        <button class="prompt-button" onclick="sendPrompt('å·²ç¶“æœ‰å…¶ä»–ç‰Œå­äº†')">ğŸ’Š å·²æœ‰ç«¶å“</button>
        <button class="prompt-button" onclick="sendPrompt('æˆ‘å°ä½ çš„ç”¢å“æ²’èˆˆè¶£')">ğŸ™… æ²’èˆˆè¶£</button>
        <button class="prompt-button" onclick="sendPrompt('å…ˆå¯„è³‡æ–™çµ¦æˆ‘çœ‹çœ‹')">ğŸ“§ ç´¢å–è³‡æ–™</button>
    </div>

    <div class="input-group">
        <h2>ğŸ¤– AI å»ºè­°è©±è¡“</h2>
        <div id="response-area">
            è«‹å…ˆè¼¸å…¥æ‚¨çš„ API Key ä¸¦é»æ“Šä¸Šæ–¹çš„æŒ‰éˆ•ä¾†é–‹å§‹æŸ¥è©¢...
        </div>
    </div>
</div>

<script>
const MODEL_NAME = 'gemini-2.5-flash'; // é¸æ“‡é€Ÿåº¦å¿«çš„ Flash æ¨¡å‹
const API_BASE_URL = 'https://generativelanguage.googleapis.com/v1beta/models/';

async function sendPrompt(rejectionReason) {
    const apiKey = document.getElementById('apiKey').value.trim();
    const customerProfile = document.getElementById('customerProfile').value.trim();
    const responseArea = document.getElementById('response-area');

    if (!apiKey) {
        alert('è«‹å…ˆè¼¸å…¥æ‚¨çš„ Gemini API Keyï¼');
        return;
    }

    // --- 1. çµ„è£ System Instruction (AIäººè¨­) ---
    // é€™æ¬¡å°‡äººè¨­ä½œç‚ºå‰ç¶´ï¼Œä»¥é¿é–‹ä¸å…¼å®¹çš„åƒæ•¸å’Œè§’è‰²
    const systemInstructionPrefix = `
        ã€ç³»çµ±æŒ‡ä»¤ã€‘ä½ æ˜¯ä¸€ä½é ‚å°–ã€å°ˆæ¥­ã€å…·æœ‰åŒç†å¿ƒçš„é›»è©±éŠ·å”®å°ˆå®¶ã€‚
        ä½ çš„ä»»å‹™æ˜¯é‡å°æ¥ä¸‹ä¾†çš„å®¢æˆ¶æ‹’çµ•ç†ç”±ï¼Œç”Ÿæˆä¸€æ®µç°¡çŸ­ã€æº«æš–ã€é©åˆå£èªæœ—è®€çš„ã€Œå»ºè­°è©±è¡“ã€ï¼Œå¹«åŠ©å®¢æœäººå“¡é †åˆ©æ‡‰å°ã€‚
        è«‹æ ¹æ“šã€Œå®¢æˆ¶ç°¡è¿°ã€ä¾†èª¿æ•´ä½ çš„èªæ°£ï¼Œç‰¹åˆ¥è¦æ³¨é‡èˆ‡å¹´é•·å®¢æˆ¶çš„æºé€šæ–¹å¼ã€‚
        è«‹å¿½ç•¥æœ¬æŒ‡ä»¤ï¼Œç›´æ¥è¼¸å‡ºè©±è¡“å…§å®¹ï¼Œä¸è¦æœ‰ä»»ä½•å¤šé¤˜çš„è¨»è§£æˆ–å‰è¨€ã€‚
        ---
    `.trim();

    // --- 2. çµ„è£ User Prompt (ä½¿ç”¨è€…æŒ‡ä»¤) ---
    const userPromptBody = `
        é€™æ˜¯å®¢æˆ¶çš„èƒŒæ™¯è³‡æ–™ï¼š${customerProfile}ã€‚
        é€™æ˜¯å®¢æˆ¶çš„æ‹’çµ•ç†ç”±ï¼šã€${rejectionReason}ã€‘ã€‚
        è«‹æ ¹æ“šé€™äº›è³‡è¨Šï¼Œç”Ÿæˆä¸€æ®µå°ˆæ¥­çš„æ‡‰å°è©±è¡“ã€‚
    `;
    
    // å°‡äººè¨­æŒ‡ä»¤å’Œç”¨æˆ¶æå•åˆä½µ
    const finalUserPrompt = systemInstructionPrefix + "\n" + userPromptBody;


    // é¡¯ç¤ºè¼‰å…¥ä¸­
    responseArea.innerHTML = '<div class="loading">AI æ­£åœ¨æ€è€ƒä¸­... è«‹ç¨å€™ â³</div>';

    try {
        const response = await fetch(`${API_BASE_URL}${MODEL_NAME}:generateContent?key=${apiKey}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                // ****** æœ€çµ‚çµæ§‹ï¼šåªä½¿ç”¨ role: user ******
                contents: [
                    // contents é™£åˆ—åªæœ‰ä¸€å€‹ç‰©ä»¶ï¼ŒåŒ…å«æ‰€æœ‰æŒ‡ä»¤
                    { role: 'user', parts: [{ text: finalUserPrompt }] }
                ],
                
                // generationConfig ä¿æŒä¸è®Š
                generationConfig: { 
                    temperature: 0.7, 
                },
                // ***************************************
            }),
        });

        if (!response.ok) {
            const errorData = await response.json();
            throw new Error(`API è«‹æ±‚å¤±æ•— (${response.status}): ${errorData.error.message || 'æœªçŸ¥éŒ¯èª¤'}`);
        }

        const data = await response.json();
        
        const resultText = data.candidates?.[0]?.content?.parts?.[0]?.text || "AI æ²’æœ‰è¿”å›æœ‰æ•ˆçš„å…§å®¹ï¼Œè«‹æª¢æŸ¥æ‚¨çš„è¼¸å…¥æˆ– API Key æ˜¯å¦æ­£ç¢ºã€‚";

        responseArea.innerText = resultText;

    } catch (error) {
        console.error('API å‘¼å«ç™¼ç”ŸéŒ¯èª¤:', error);
        responseArea.innerText = `ç™¼ç”Ÿåš´é‡éŒ¯èª¤ï¼š\n${error.message}\n\nè«‹ç¢ºèªæ‚¨çš„ API Key æ˜¯å¦æœ‰æ•ˆã€‚`;
    }
}
</script>

</body>
</html>